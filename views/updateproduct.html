
</head>
<body>
    <div class="container">
        <table class="table" id = "myTable">
          <thead>
            <tr>
              <th>Product #</th>
              <th>Product Name</th>
              <th>Product Picture</th>
              <th>Product Category</th>
            </tr>
          </thead>
          <tbody id="data">
          </tbody>
        </table>
      </div>
    <div>
    <button  id="myButton">Se product</button><br><br>
</div>

<div>
    <input id="value" type="text" name="Product number" placeholder="Product number to update" required>  <br>  
    <br><button id="updateproduct">get product details</button>
</div>
    <input type="text" id="productname" placeholder="Product name" required >
    <input type="text" id="productpicture" placeholder="billed" required >
    <input type="text" id="productcategory" placeholder="Categoty" required>
    <input type="text" id="productprice" placeholder="price" required>
    <br><input id="save" type="submit" value = "Save">
</body>
</html>

<script>
  document.getElementById("save").onclick = function () {
        var dist = document.getElementById('value').value; // change here
        var productname = document.getElementById('productname').value
        var productpicture = document.getElementById('productpicture').value
        var productcategory = document.getElementById('productcategory').value
        var productprice = document.getElementById('productprice').value
        let parameter = '?productname=' + productname
        parameter = parameter + '&productpicture=' + productpicture
        parameter  = parameter + '&productcategory=' + productcategory
        parameter = parameter + '&productprice=' + productprice
        parameter = parameter + '&index=' + dist

       fetch('http://localhost:3000/updateproductwithid' + parameter, {method: 'POST'})
        .then((response) => response.json())
        .then((data) => {
            console.log(data);
        })
    .catch(error => console.warn(error));
    }

    document.getElementById("updateproduct").onclick = function () {
        var dist = document.getElementById('value').value; // change here
       fetch('http://localhost:3000/updateproductdetail?value=' + dist, {method : 'GET'})
        .then((response) => response.json())
        .then((data) => {
            product = Object.values(data)
            document.getElementById('productname').value = product[0]
            document.getElementById('productpicture').value = product[1]
            document.getElementById('productcategory').value = product[2]
            document.getElementById('productprice').value = product[3]
            console.log(data);
        })
    .catch(error => console.warn(error));
    }

    console.log('client side code running');
    const button = document.getElementById('myButton');
    button.addEventListener('click', function(e){
        fetch('http://localhost:3000/getallproducts', {method : 'GET'})
        .then((response) => response.json())
        .then((data) => {
            var table = document.getElementById('data');
            var myTable = document.getElementById("myTable");
            var rowCount = myTable.rows.length;
            for (var x=rowCount-1; x>0; x--) {
              myTable.deleteRow(x);
            }
            var index = 1;
            for (let product of Object.values(data))
            {
                const row = table.insertRow();
                const id = row.insertCell(0)
                const title = row.insertCell(1);
                const picture = row.insertCell(2);
                const category = row.insertCell(3);
                const price = row.insertCell(4);

                id.innerHTML = index++;
                title.innerHTML = product.productname;
                picture.innerHTML = product.productpicture;
                category.innerHTML = product.productcategory;
                price.innerHTML = product.productprice;
            }
            console.log(data);
        })
    .catch(error => console.warn(error));
    })
</script>

